#pragma OPENCL EXTENSION cl_khr_int64_extended_atomics : enable

#define MUL 0x5DEECE66D
#define ADDEND 0xB
#define MASK ((1l << 48) - 1)

void kernel rand_byte (const ulong n, const ulong offset, __global ulong *seed, __global uchar *out) {
    for (ulong id = get_global_id(0) + offset; id<n; id += get_global_size(0)) {
        ulong prev = seed[id];
        ulong next = (prev * MUL + ADDEND) & MASK;

        seed[id] = next;
        out[id] = (uchar) (next >> (48 - 8));
    }
}